---
// Importa las funciones necesarias para hacer un fetch a la API de CoinGecko
const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=10&page=1&sparkline=false');
const cryptoData = await response.json(); // Obtén los datos en formato JSON

// Mapea los datos a un formato más sencillo si es necesario
const simplifiedData = cryptoData.map(coin => ({
  rank: coin.market_cap_rank,
  name: coin.name,
  symbol: coin.symbol,
  price: `$${coin.current_price.toLocaleString()}`, // Formato de precio
  change: `${coin.price_change_percentage_24h}%`, // Cambio en 24h
  marketCap: `$${coin.market_cap.toLocaleString()}`, // Capitalización de mercado
  volume: `$${coin.total_volume.toLocaleString()}`, // Volumen en 24h
  changePositive: coin.price_change_percentage_24h >= 0 // Para determinar el color del cambio
}));
---

<div class="w-full h-auto py-40">
  <table class="w-4/6 mx-auto bg-[#282A36] text-[#F8F8F2] rounded-lg shadow-lg">
    <thead class="bg-[#44475A] text-[#F8F8F2]">
      <tr>
        <th class="text-left p-4">#</th>
        <th class="text-left p-4">Name</th>
        <th class="text-right p-4">Price</th>
        <th class="text-right p-4">24h%</th>
        <th class="text-right p-4">Market cap</th>
        <th class="text-right p-4">Volumen 24h</th>
      </tr>
    </thead>
    <tbody>
      {simplifiedData.map((coin) => (
        <tr class={`border-b border-[#6272a4] hover:bg-[#5A5C7A] transition duration-200`}>
          <td class="p-4">{coin.rank}</td>
          <td class="p-4 flex items-center gap-2">
            <span>{coin.name}</span>
            <span class="text-[#50fa7b]">{coin.symbol}</span>
          </td>
          <td class="p-4 text-right">{coin.price}</td>
          <td class={`p-4 text-right ${coin.changePositive ? 'text-[#50fa7b]' : 'text-[#ff5555]'}`}>{coin.change}</td>
          <td class="p-4 text-right">{coin.marketCap}</td>
          <td class="p-4 text-right">{coin.volume}</td>
        </tr>
      ))}
    </tbody>
  </table>
  <div class="flex justify-center mt-8">
    <button class="bg-[#44475A] text-[#F8F8F2] font-semibold py-2 px-4 rounded-lg shadow-lg hover:bg-[#6272a4] transition duration-200">
      Explorar Mercado
    </button>
  </div>
</div>
